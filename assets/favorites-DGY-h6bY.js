import{m as w,r as n,j as s,a as b}from"./index-ELto49OG.js";import{u as P,J as f,A as x,C as j}from"./jobCard-D7oVXYpO.js";import{L as v}from"./loader-circle-Ag9EYWyz.js";const F=({type:r})=>{async function c({pageParam:t=1}){return(await w.get(`/api/favorites/${r}/${t}`)).data.posts}return P({staleTime:300*1e3,queryKey:["favorite",r],queryFn:c,initialPageParam:1,refetchOnWindowFocus:!1,getNextPageParam:(t,i)=>t.length<19?void 0:i.length+1})},E=({vr:r,type:c="news"})=>{const{data:t,fetchNextPage:i,hasNextPage:u,isFetchingNextPage:l,isLoading:p}=F({type:c}),d=n.useMemo(()=>t?.pages.flat()??[],[t]),o=n.useRef(null),m=n.useRef(l);n.useEffect(()=>{m.current=l},[l]);const h=n.useCallback(e=>{e&&(!u||l||(o.current&&o.current.disconnect(),o.current=new IntersectionObserver(a=>{a[0].isIntersecting&&!m.current&&i()},{threshold:.1}),e&&o.current.observe(e)))},[i,u]);n.useEffect(()=>()=>o.current?.disconnect(),[]);const N=e=>{switch(e.type){case"news":return s.jsx(j,{className:"py-1",post:e,vr:r},e.id);case"shop":return s.jsx(x,{className:"py-1",ad:e,vr:r},e.id);case"job":return s.jsx(f,{className:"py-1",job:e,vr:r},e.id);default:return null}},y=e=>{switch(c){case"news":return e.map(a=>s.jsx(j,{className:"py-1",post:a,vr:r},a.id));case"shopping":return e.map(a=>s.jsx(x,{className:"py-1",ad:a,vr:r},a.id));case"job":return e.map(a=>s.jsx(f,{className:"py-1",job:a,vr:r},a.id));default:return null}};return s.jsx("div",{className:"py-2.5",children:s.jsxs("div",{className:b("grid gap-6 md:gap-7"),children:[p&&s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsx(g,{})}),c==="all"?d.map(N):y(d),u&&s.jsx("div",{ref:h,className:"flex items-center justify-center py-20",children:l&&s.jsx(g,{})})]})})},g=()=>s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(v,{className:"h-5 w-5 animate-spin"}),s.jsx("span",{className:"text-sm",children:"Loading more posts..."})]});export{E as F};
