import{D as w,r as n,j as s,a as b,q as P}from"./index-dm3QBHmQ.js";import{u as v,J as m,A as x,C as j}from"./jobCard-wSLJLcu8.js";const F=({type:r})=>{async function c({pageParam:t=1}){return(await w.get(`/api/favorites/${r}/${t}`)).data.posts}return v({staleTime:300*1e3,queryKey:["favorite",r],queryFn:c,initialPageParam:1,refetchOnWindowFocus:!1,getNextPageParam:(t,i)=>t.length<19?void 0:i.length+1})},E=({vr:r,type:c="news"})=>{const{data:t,fetchNextPage:i,hasNextPage:o,isFetchingNextPage:l,isLoading:h}=F({type:c}),d=n.useMemo(()=>t?.pages.flat()??[],[t]),u=n.useRef(null),f=n.useRef(l);n.useEffect(()=>{f.current=l},[l]);const p=n.useCallback(e=>{e&&(!o||l||(u.current&&u.current.disconnect(),u.current=new IntersectionObserver(a=>{a[0].isIntersecting&&!f.current&&i()},{threshold:.1}),e&&u.current.observe(e)))},[i,o]);n.useEffect(()=>()=>u.current?.disconnect(),[]);const N=e=>{switch(e.type){case"news":return s.jsx(j,{className:"py-1",post:e,vr:r},e.id);case"shop":return s.jsx(x,{className:"py-1",ad:e,vr:r},e.id);case"job":return s.jsx(m,{className:"py-1",job:e,vr:r},e.id);default:return null}},y=e=>{switch(c){case"news":return e.map(a=>s.jsx(j,{className:"py-1",post:a,vr:r},a.id));case"shopping":return e.map(a=>s.jsx(x,{className:"py-1",ad:a,vr:r},a.id));case"job":return e.map(a=>s.jsx(m,{className:"py-1",job:a,vr:r},a.id));default:return null}};return s.jsx("div",{className:"py-2.5",children:s.jsxs("div",{className:b("grid gap-6 md:gap-7"),children:[h&&s.jsx("div",{className:"flex items-center justify-center py-20",children:s.jsx(g,{})}),c==="all"?d.map(N):y(d),o&&s.jsx("div",{ref:p,className:"flex items-center justify-center py-20",children:l&&s.jsx(g,{})})]})})},g=()=>s.jsxs("div",{className:"flex items-center gap-2 text-muted-foreground",children:[s.jsx(P,{className:"h-5 w-5 animate-spin"}),s.jsx("span",{className:"text-sm",children:"Loading more posts..."})]});export{E as F};
