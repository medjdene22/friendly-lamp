import{l as f,r as i,am as S,an as W,ay as $,j as e,af as _,ag as z,ah as E,ai as M,aj as A,ab as m,ac as h,o as F,az as u,D as O,x as g}from"./index-SNKWFbRR.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],w=f("eye-off",Z);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],x=f("eye",L);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],p=f("lock",q),D=$({currentPassword:u().min(1,"Current password is required"),newPassword:u().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/[0-9]/,"Password must contain at least one number"),confirmPassword:u()}).refine(a=>a.newPassword===a.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function B(){const[a,j]=i.useState(!1),[d,N]=i.useState(!1),[l,P]=i.useState(!1),{register:c,handleSubmit:y,reset:b,watch:v,formState:{errors:r}}=S({resolver:W(D)}),o=v("newPassword"),n=(t=>{if(!t)return{strength:0,label:"",color:""};let s=0;return t.length>=8&&s++,t.length>=12&&s++,/[A-Z]/.test(t)&&s++,/[a-z]/.test(t)&&s++,/[0-9]/.test(t)&&s++,/[^A-Za-z0-9]/.test(t)&&s++,s<=2?{strength:33,label:"Weak",color:"bg-destructive"}:s<=4?{strength:66,label:"Medium",color:"bg-amber-500"}:{strength:100,label:"Strong",color:"bg-[#82ae26]"}})(o||"");async function k({currentPassword:t,newPassword:s}){try{await O.post("/api/auth/change-password",{old_password:t,new_password:s}),g.success("Password changed successfully"),b()}catch(C){g.error("Password change failed "+C.response.data.message)}finally{}}return e.jsx("div",{className:"flex items-center justify-center gap-1 ",children:e.jsxs("form",{onSubmit:y(k),className:"space-y-6 w-full",children:[e.jsxs(_,{className:"border-border shadow-sm hover:shadow-md transition-shadow duration-300",children:[e.jsxs(z,{children:[e.jsxs(E,{className:"flex items-center gap-2",children:[e.jsx(p,{className:"h-5 w-5  text-[#82ae26] ",strokeWidth:"2.5"}),"Change Password"]}),e.jsx(M,{children:"Ensure your account is using a strong password to stay secure"})]}),e.jsxs(A,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"currentPassword",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"currentPassword",type:a?"text":"password",placeholder:"Enter current password",...c("currentPassword"),className:"pr-10 transition-all focus:ring-2 focus:ring-[#82ae26]/20",autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>j(!a),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:a?e.jsx(w,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"}):e.jsx(x,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"})})]}),r.currentPassword&&e.jsx("p",{className:"text-sm text-destructive",children:r.currentPassword.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"newPassword",type:d?"text":"password",placeholder:"Enter new password",...c("newPassword"),className:"pr-10 transition-all focus:ring-2 focus:ring-[#82ae26]/20",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>N(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:d?e.jsx(w,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"}):e.jsx(x,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"})})]}),r.newPassword&&e.jsx("p",{className:"text-sm text-destructive",children:r.newPassword.message}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Password strength:"}),e.jsx("span",{className:`font-medium ${n.label==="Weak"?"text-destructive":n.label==="Medium"?"text-amber-500":"text-[#82ae26]"}`,children:n.label})]}),e.jsx("div",{className:"h-2 bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${n.color}`,style:{width:`${n.strength}%`}})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(m,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(h,{id:"confirmPassword",type:l?"text":"password",placeholder:"Re-enter new password",...c("confirmPassword"),className:"pr-10 transition-all focus:ring-2 focus:ring-[#82ae26]/20",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>P(!l),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:l?e.jsx(w,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"}):e.jsx(x,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"})})]}),r.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive",children:r.confirmPassword.message})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Password requirements:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${o?.length>=8?"bg-[#82ae26]":"bg-muted-foreground"}`}),"At least 8 characters long"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${/[A-Z]/.test(o||"")?"bg-[#82ae26]":"bg-muted-foreground"}`}),"One uppercase letter"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${/[a-z]/.test(o||"")?"bg-[#82ae26]":"bg-muted-foreground"}`}),"One lowercase letter"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${/[0-9]/.test(o||"")?"bg-[#82ae26]":"bg-muted-foreground"}`}),"One number"]})]})]})]})]}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsxs(F,{type:"submit",className:"min-w-[200px] w-full sm:w-fit  shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(p,{className:"mr-2 h-4 w-4"}),"Update Password"]})})]})})}export{B as component};
