import{G as f,r as i,a0 as S,j as e,a1 as m,m as W,_ as p}from"./index-BqDI3d4f.js";import{u as _,a as $}from"./zod-DMLaxhro.js";import{B as E}from"./button-DBB7yN7b.js";import{I as u}from"./input-CfwRaLLK.js";import{L as h}from"./label-D0FWi5jS.js";import{C as M,a as z,b as A,c as F,d as L}from"./card-ov1b-ciK.js";import"./index-J6NgCmWN.js";import"./index-COstmXYg.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],w=f("eye-off",O);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],x=f("eye",Z);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const I=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],g=f("lock",I),q=S({currentPassword:m().min(1,"Current password is required"),newPassword:m().min(8,"Password must be at least 8 characters").regex(/[A-Z]/,"Password must contain at least one uppercase letter").regex(/[a-z]/,"Password must contain at least one lowercase letter").regex(/[0-9]/,"Password must contain at least one number"),confirmPassword:m()}).refine(r=>r.newPassword===r.confirmPassword,{message:"Passwords don't match",path:["confirmPassword"]});function K(){const[r,j]=i.useState(!1),[d,N]=i.useState(!1),[c,P]=i.useState(!1),{register:l,handleSubmit:b,reset:y,watch:v,formState:{errors:a}}=_({resolver:$(q)}),o=v("newPassword"),n=(t=>{if(!t)return{strength:0,label:"",color:""};let s=0;return t.length>=8&&s++,t.length>=12&&s++,/[A-Z]/.test(t)&&s++,/[a-z]/.test(t)&&s++,/[0-9]/.test(t)&&s++,/[^A-Za-z0-9]/.test(t)&&s++,s<=2?{strength:33,label:"Weak",color:"bg-destructive"}:s<=4?{strength:66,label:"Medium",color:"bg-amber-500"}:{strength:100,label:"Strong",color:"bg-[#82ae26]"}})(o||"");async function k({currentPassword:t,newPassword:s}){try{await W.post("/api/auth/change-password",{old_password:t,new_password:s}),p.success("Password changed successfully"),y()}catch(C){p.error("Password change failed "+C.response.data.message)}finally{}}return e.jsx("div",{className:"flex items-center justify-center gap-1 ",children:e.jsxs("form",{onSubmit:b(k),className:"space-y-6 w-full",children:[e.jsxs(M,{className:"border-border shadow-sm hover:shadow-md transition-shadow duration-300",children:[e.jsxs(z,{children:[e.jsxs(A,{className:"flex items-center gap-2",children:[e.jsx(g,{className:"h-5 w-5  text-[#82ae26] ",strokeWidth:"2.5"}),"Change Password"]}),e.jsx(F,{children:"Ensure your account is using a strong password to stay secure"})]}),e.jsxs(L,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"currentPassword",children:"Current Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{id:"currentPassword",type:r?"text":"password",placeholder:"Enter current password",...l("currentPassword"),className:"pr-10 transition-all focus:ring-2 focus:ring-[#82ae26]/20",autoComplete:"current-password"}),e.jsx("button",{type:"button",onClick:()=>j(!r),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:r?e.jsx(w,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"}):e.jsx(x,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"})})]}),a.currentPassword&&e.jsx("p",{className:"text-sm text-destructive",children:a.currentPassword.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"newPassword",children:"New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{id:"newPassword",type:d?"text":"password",placeholder:"Enter new password",...l("newPassword"),className:"pr-10 transition-all focus:ring-2 focus:ring-[#82ae26]/20",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>N(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:d?e.jsx(w,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"}):e.jsx(x,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"})})]}),a.newPassword&&e.jsx("p",{className:"text-sm text-destructive",children:a.newPassword.message}),o&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-muted-foreground",children:"Password strength:"}),e.jsx("span",{className:`font-medium ${n.label==="Weak"?"text-destructive":n.label==="Medium"?"text-amber-500":"text-[#82ae26]"}`,children:n.label})]}),e.jsx("div",{className:"h-2 bg-secondary rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all duration-300 ${n.color}`,style:{width:`${n.strength}%`}})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(h,{htmlFor:"confirmPassword",children:"Confirm New Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{id:"confirmPassword",type:c?"text":"password",placeholder:"Re-enter new password",...l("confirmPassword"),className:"pr-10 transition-all focus:ring-2 focus:ring-[#82ae26]/20",autoComplete:"new-password"}),e.jsx("button",{type:"button",onClick:()=>P(!c),className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground hover:text-foreground transition-colors",children:c?e.jsx(w,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"}):e.jsx(x,{className:"h-4 w-4 text-[#82ae26] ",strokeWidth:"2.5"})})]}),a.confirmPassword&&e.jsx("p",{className:"text-sm text-destructive",children:a.confirmPassword.message})]}),e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-2",children:[e.jsx("p",{className:"text-sm font-medium text-foreground",children:"Password requirements:"}),e.jsxs("ul",{className:"text-sm text-muted-foreground space-y-1",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${o?.length>=8?"bg-[#82ae26]":"bg-muted-foreground"}`}),"At least 8 characters long"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${/[A-Z]/.test(o||"")?"bg-[#82ae26]":"bg-muted-foreground"}`}),"One uppercase letter"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${/[a-z]/.test(o||"")?"bg-[#82ae26]":"bg-muted-foreground"}`}),"One lowercase letter"]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`h-1.5 w-1.5 rounded-full ${/[0-9]/.test(o||"")?"bg-[#82ae26]":"bg-muted-foreground"}`}),"One number"]})]})]})]})]}),e.jsx("div",{className:"flex justify-end gap-4",children:e.jsxs(E,{type:"submit",className:"min-w-[200px] w-full sm:w-fit  shadow-lg hover:shadow-xl transition-all duration-300",children:[e.jsx(g,{className:"mr-2 h-4 w-4"}),"Update Password"]})})]})})}export{K as component};
