import{a3 as f,r as j,a2 as P,j as r,X as C,t as w}from"./index-BdqRUGKt.js";import{u as g,a as v,C as i}from"./zod-Bx9n9BJV.js";import{C as b,a as O,b as y,c as F,d as S,e as R}from"./card-XCGFoiXO.js";import{F as D,a as n,b as t,d,c}from"./field-OI_38DFh.js";import{I as l}from"./input-BciPiqCc.js";import{B as N}from"./button-BYwslC_x.js";import{L as T}from"./loader-circle-CQuOfnsK.js";import"./label-BMoW_mP4.js";import"./index-DBzOYNu8.js";import"./index-DBXKSM9E.js";function U(){const[e,p]=j.useState(!1),u=P({currentPassword:m(),newPassword:m(),confirmPassword:m()}).refine(a=>a.newPassword===a.confirmPassword,{message:"PASSWORDS MUST MATCH",path:["confirmPassword"]}),o=g({resolver:v(u),defaultValues:{currentPassword:"",newPassword:"",confirmPassword:""}});async function h({currentPassword:a,newPassword:s}){try{p(!0),await C.changePassword({currentPassword:a,newPassword:s,revokeOtherSessions:!0,fetchOptions:{throw:!0}}),w.success("Password changed successfully")}catch(x){w.error("Password change failed "+x)}finally{p(!1)}}return r.jsx("div",{className:"flex items-center justify-center py-8 bg-slate-200 dark:bg-transparent",children:r.jsxs(b,{className:"w-full sm:max-w-lg  dark:bg-slate-950",children:[r.jsxs(O,{children:[r.jsx(y,{className:"text-base sm:text-xl",children:"Change Password"}),r.jsx(F,{className:"text-xs sm:text-base",children:"Set a new password for your account"})]}),r.jsx(S,{children:r.jsx("form",{id:"form-rhf-input",onSubmit:o.handleSubmit(h),children:r.jsxs(D,{children:[r.jsx(i,{name:"currentPassword",control:o.control,render:({field:a,fieldState:s})=>r.jsxs(n,{"data-invalid":s.invalid,children:[r.jsx(t,{htmlFor:"form-rhf-input-currentPassword",children:"Current Password"}),r.jsx(l,{...a,type:"password",id:"form-rhf-input-currentPassword","aria-invalid":s.invalid,placeholder:"current password",autoComplete:"current-password"}),r.jsx(d,{}),s.invalid&&r.jsx(c,{errors:[s.error]})]})}),r.jsx(i,{name:"newPassword",control:o.control,render:({field:a,fieldState:s})=>r.jsxs(n,{"data-invalid":s.invalid,children:[r.jsx(t,{htmlFor:"form-rhf-input-newPassword",children:"New Password"}),r.jsx(l,{type:"password",...a,id:"form-rhf-input-newPassword","aria-invalid":s.invalid,placeholder:"new password",autoComplete:"new-password"}),r.jsx(d,{}),s.invalid&&r.jsx(c,{errors:[s.error]})]})}),r.jsx(i,{name:"confirmPassword",control:o.control,render:({field:a,fieldState:s})=>r.jsxs(n,{"data-invalid":s.invalid,children:[r.jsx(t,{htmlFor:"form-rhf-input-confirmPassword",children:"Confirm Password"}),r.jsx(l,{...a,type:"password",id:"form-rhf-input-confirmPassword","aria-invalid":s.invalid,placeholder:"current password",autoComplete:"current-password"}),r.jsx(d,{}),s.invalid&&r.jsx(c,{errors:[s.error]})]})})]})})}),r.jsx(R,{children:r.jsx(n,{orientation:"responsive",children:r.jsxs(N,{type:"submit",form:"form-rhf-input",children:[e&&r.jsx(T,{className:"animate-spin"}),e?"Changing password...":"Change Password"]})})})]})})}function m(){let e=f().min(1,{message:"PASSWORD REQUIRED"});return e=e.min(8,{message:"PASSWORD TOO SHORT"}),e=e.max(18,{message:"PASSWORD TOO LONG"}),e}export{U as component,m as getPasswordSchema};
